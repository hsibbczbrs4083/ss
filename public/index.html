<h1>微软OAuth2认证API网关文档</h1>
<div><br>
</div><p>欢迎访问微软Oauth2认证接口的前端&amp;文档界面，本项目基于Vercel云平台，将微软OAuth2认证流程封装成简洁高效的API接口，开发者只需通过Post/Get简单调用本接口即可实现安全可靠的收发件功能，无需关心底层认证细节，使得开发者可以专注于业务逻辑开发，而将复杂的OAuth2验证流程托管给本轻量级接口服务。</p>
<h2>本接口的特点：</h2>
<ol>
<li>Serverless架构：自动扩展、全球边缘网络加速，降低您的收发件成本，提高收发件效率。</li>
<li>支持 Graph API 取件： 会自动判断是否是Graph API，自适应渲染HTML/text内容。</li>
<li>多线程处理：嵌入优化的 多线程处理机制，显著提升批量收件效率，可轻松支持高并发场景。</li>
<li>服务可用性SLA：基于Vercel云平台，无需维护基本可超长时间高SLA稳定运行。</li>
<li>请求格式简单：Post/Get本接口即可调用，搭配本店定制调用WebUI可实现批量导入导出、数据托管D1数据库、一键收发件，也可将其集成到注册机脚本中，满足您的个性化需求。</li>
<li>永久超低成本收发件：Serverless架构显著降低了本服务的运行维护成本，事实上，初始接口自研发至今，在基本不维护的情况下已稳定运行两年。</li>
</ol>
<div><br>
</div><h2>后续更新：</h2>
<ol>
<li>纯本地Oauth2接口收发件(即数据和接口都运行在本地) ；</li>
<li>Gmail、QQ邮箱的收发（IMAP邮箱）</li>
<li>WebUI端批量收发（目前只有API端可批量收发）</li>
<li>本地批量收发（相当于买断制的心蓝，只需一次付费永久可用，无需每年高价订阅心蓝）</li>
</ol>
<div><br>
</div><p>以上更新完成后都会在闲鱼店上新，感兴趣的话请关注本店。</p>
<p>📌 我的闲鱼店：<strong>七号楼长</strong>: <a href="https://m.tb.cn/h.68Af0U7?tk=rnc6VXa64S5" target="_blank">👉点击此处👈</a> （网页端不支持直接访问店铺，请扫码跳转移动端哦！）</p>
<div><br>
</div><h2>API文档</h2>
<h3><strong>获取最新一封邮件</strong> <a href="#-%E8%8E%B7%E5%8F%96%E6%9C%80%E6%96%B0%E4%B8%80%E5%B0%81%E9%82%AE%E4%BB%B6">​</a></h3>
<p><strong>方法:</strong> <code>GET</code> 或 <code>POST</code><br>
<strong>URL:</strong> <code>/api/mail-new</code><br>
<strong>描述:</strong> 获取最新的一封邮件。如果邮件中含有 6 位数字验证码，会自动提取。</p>
<p><strong>参数说明:</strong></p>
<ul>
<li><code>refresh_token</code> (必填): 用于身份验证的 refresh_token。</li>
<li><code>client_id</code> (必填): 客户端 ID。</li>
<li><code>email</code> (必填): 邮箱地址。</li>
<li><code>mailbox</code> (必填): 邮箱文件夹，支持的值为 <code>INBOX</code> 或 <code>Junk</code>。</li>
<li><code>response_type</code> (可选): 返回格式，支持的值为 <code>json</code> 或 <code>html</code>，默认为 <code>json</code>。</li>
<li><code>password</code> (可选): 为增强接口安全性，防止滥用，现已支持密码验证功能。您可以通过在环境变量中配置 password 来启用此功能。启用后，请求时需提供正确的 password 参数方可访问。</li>
</ul>
<p><strong>使用示例:</strong></p>
<p><strong>JavaScript (Fetch API):</strong></p>
<p>JavaScript</p>
<div><!--beforebegin--><div class="v-md-pre-wrapper copy-code-mode v-md-pre-wrapper- extra-class" extra-attr=""><!--afterbegin--><pre class="v-md-prism-"><code>// GET 请求
fetch('https://yourdomain.com/api/mail-new?refresh_token=your_refresh_token&amp;client_id=your_client_id&amp;email=your_email@example.com&amp;mailbox=INBOX&amp;response_type=json')
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; console.error('Error:', error));

// POST 请求
fetch('https://yourdomain.com/api/mail-new', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    refresh_token: 'your_refresh_token',
    client_id: 'your_client_id',
    email: 'your_email@example.com',
    mailbox: 'INBOX',
    response_type: 'json'
  })
})
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; console.error('Error:', error));
</code></pre>

    <button class="v-md-copy-code-btn" type="button">
      <i>
        <svg viewBox="64 64 896 896" focusable="false" data-icon="copy" width="1em" height="1em" fill="currentColor" aria-hidden="true">
          <path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path>
        </svg>
      </i>
    </button><!--beforeend--></div><!--afterend--></div><hr>
<h3><strong>获取全部邮件</strong> <a href="#-%E8%8E%B7%E5%8F%96%E5%85%A8%E9%83%A8%E9%82%AE%E4%BB%B6">​</a></h3>
<p><strong>方法:</strong> <code>GET</code> 或 <code>POST</code><br>
<strong>URL:</strong> <code>/api/mail-all</code><br>
<strong>描述:</strong> 获取全部邮件。如果邮件中含有 6 位数字验证码，会自动提取。</p>
<p><strong>参数说明:</strong></p>
<ul>
<li><code>refresh_token</code> (必填): 用于身份验证的 refresh_token。</li>
<li><code>client_id</code> (必填): 客户端 ID。</li>
<li><code>email</code> (必填): 邮箱地址。</li>
<li><code>mailbox</code> (必填): 邮箱文件夹，支持的值为 <code>INBOX</code> 或 <code>Junk</code>。</li>
<li><code>password</code> (可选): 为增强接口安全性，防止滥用，现已支持密码验证功能。您可以通过在环境变量中配置 password 来启用此功能。启用后，请求时需提供正确的 password 参数方可访问。</li>
</ul>
<p><strong>使用示例:</strong></p>
<p><strong>JavaScript (Fetch API):</strong></p>
<p>JavaScript</p>
<div><!--beforebegin--><div class="v-md-pre-wrapper copy-code-mode v-md-pre-wrapper- extra-class" extra-attr=""><!--afterbegin--><pre class="v-md-prism-"><code>// GET 请求
fetch('https://yourdomain.com/api/mail-all?refresh_token=your_refresh_token&amp;client_id=your_client_id&amp;email=your_email@example.com&amp;mailbox=INBOX')
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; console.error('Error:', error));

// POST 请求
fetch('https://yourdomain.com/api/mail-all', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    refresh_token: 'your_refresh_token',
    client_id: 'your_client_id',
    email: 'your_email@example.com',
    mailbox: 'INBOX'
  })
})
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; console.error('Error:', error));
</code></pre>

    <button class="v-md-copy-code-btn" type="button">
      <i>
        <svg viewBox="64 64 896 896" focusable="false" data-icon="copy" width="1em" height="1em" fill="currentColor" aria-hidden="true">
          <path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path>
        </svg>
      </i>
    </button><!--beforeend--></div><!--afterend--></div><hr>
<h3><strong>清空收件箱</strong> <a href="#-%E6%B8%85%E7%A9%BA%E6%94%B6%E4%BB%B6%E7%AE%B1">​</a></h3>
<p><strong>方法:</strong> <code>GET</code> 或 <code>POST</code><br>
<strong>URL:</strong> <code>/api/process-inbox</code><br>
<strong>描述:</strong> 清空收件箱。</p>
<p><strong>参数说明:</strong></p>
<ul>
<li><code>refresh_token</code> (必填): 用于身份验证的 refresh_token。</li>
<li><code>client_id</code> (必填): 客户端 ID。</li>
<li><code>email</code> (必填): 邮箱地址。</li>
<li><code>password</code> (可选): 为增强接口安全性，防止滥用，现已支持密码验证功能。您可以通过在环境变量中配置 password 来启用此功能。启用后，请求时需提供正确的 password 参数方可访问。</li>
</ul>
<p><strong>使用示例:</strong></p>
<p><strong>JavaScript (Fetch API):</strong></p>
<p>JavaScript</p>
<div><!--beforebegin--><div class="v-md-pre-wrapper copy-code-mode v-md-pre-wrapper- extra-class" extra-attr=""><!--afterbegin--><pre class="v-md-prism-"><code>// GET 请求
fetch('https://yourdomain.com/api/process-inbox?refresh_token=your_refresh_token&amp;client_id=your_client_id&amp;email=your_email@example.com')
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; console.error('Error:', error));

// POST 请求
fetch('https://yourdomain.com/api/process-inbox', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    refresh_token: 'your_refresh_token',
    client_id: 'your_client_id',
    email: 'your_email@example.com'
  })
})
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; console.error('Error:', error));
</code></pre>

    <button class="v-md-copy-code-btn" type="button">
      <i>
        <svg viewBox="64 64 896 896" focusable="false" data-icon="copy" width="1em" height="1em" fill="currentColor" aria-hidden="true">
          <path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path>
        </svg>
      </i>
    </button><!--beforeend--></div><!--afterend--></div><hr>
<h3><strong>清空垃圾箱</strong> <a href="#-%E6%B8%85%E7%A9%BA%E5%9E%83%E5%9C%BE%E7%AE%B1">​</a></h3>
<p><strong>方法:</strong> <code>GET</code> 或 <code>POST</code><br>
<strong>URL:</strong> <code>/api/process-junk</code><br>
<strong>描述:</strong> 清空垃圾箱。</p>
<p><strong>参数说明:</strong></p>
<ul>
<li><code>refresh_token</code> (必填): 用于身份验证的 refresh_token。</li>
<li><code>client_id</code> (必填): 客户端 ID。</li>
<li><code>email</code> (必填): 邮箱地址。</li>
<li><code>password</code> (可选): 为增强接口安全性，防止滥用，现已支持密码验证功能。您可以通过在环境变量中配置 password 来启用此功能。启用后，请求时需提供正确的 password 参数方可访问。</li>
</ul>
<p><strong>使用示例:</strong></p>
<p><strong>JavaScript (Fetch API):</strong></p>
<p>JavaScript</p>
<div><!--beforebegin--><div class="v-md-pre-wrapper copy-code-mode v-md-pre-wrapper- extra-class" extra-attr=""><!--afterbegin--><pre class="v-md-prism-"><code>// GET 请求
fetch('https://yourdomain.com/api/process-junk?refresh_token=your_refresh_token&amp;client_id=your_client_id&amp;email=your_email@example.com')
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; console.error('Error:', error));

// POST 请求
fetch('https://yourdomain.com/api/process-junk', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    refresh_token: 'your_refresh_token',
    client_id: 'your_client_id',
    email: 'your_email@example.com'
  })
})
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; console.error('Error:', error));
</code></pre>

    <button class="v-md-copy-code-btn" type="button">
      <i>
        <svg viewBox="64 64 896 896" focusable="false" data-icon="copy" width="1em" height="1em" fill="currentColor" aria-hidden="true">
          <path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path>
        </svg>
      </i>
    </button><!--beforeend--></div><!--afterend--></div><hr>
<h3><strong>发送邮件</strong> <a href="#-%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6">​</a></h3>
<p><strong>方法:</strong> <code>GET</code> 或 <code>POST</code><br>
<strong>URL:</strong> <code>/api/send-mail</code><br>
<strong>描述:</strong> 发送邮件。支持纯文本（<code>text</code>）或 HTML 格式（<code>html</code>）的内容。</p>
<p><strong>参数说明:</strong></p>
<ul>
<li><code>refresh_token</code> (必填): 用于身份验证的 refresh_token。</li>
<li><code>client_id</code> (必填): 客户端 ID。</li>
<li><code>email</code> (必填): 发件人邮箱地址。</li>
<li><code>to</code> (必填): 收件人邮箱地址。</li>
<li><code>subject</code> (必填): 邮件主题。</li>
<li><code>text</code> (可选): 邮件的纯文本内容（与 <code>html</code> 二选一）。</li>
<li><code>html</code> (可选): 邮件的 HTML 内容（与 <code>text</code> 二选一）。</li>
<li><code>send_password</code> (可选): 为增强接口安全性，防止滥用，现已支持密码验证功能。您可以通过在环境变量中配置 SEND_PASSWORD 来启用此功能。启用后，请求时需提供正确的 SEND_PASSWORD 参数方可访问。</li>
</ul>
<p><strong>使用示例:</strong></p>
<p><strong>JavaScript (Fetch API):</strong></p>
<p>JavaScript</p>
<div><!--beforebegin--><div class="v-md-pre-wrapper copy-code-mode v-md-pre-wrapper-html extra-class" extra-attr=""><!--afterbegin--><pre class="v-md-prism-html"><code>// GET 请求
fetch('https://yourdomain.com/api/send-mail?refresh_token=your_refresh_token&amp;client_id=your_client_id&amp;email=your_email@example.com&amp;to=recipient@example.com&amp;subject=Hello&amp;text=This
is a test email') .then(response =&gt; response.json()) .then(data =&gt;
console.log(data)) .catch(error =&gt; console.error('Error:', error)); // POST 请求
fetch('https://yourdomain.com/api/send-mail', { method: 'POST', headers: {
'Content-Type': 'application/json' }, body: JSON.stringify({ refresh_token:
'your_refresh_token', client_id: 'your_client_id', email:
'your_email@example.com', to: 'recipient@example.com', subject: 'Hello', text:
'This is a test email', // 或者使用 html: '
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>This is a test email<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
' }) }) .then(response =&gt; response.json()) .then(data =&gt; console.log(data))
.catch(error =&gt; console.error('Error:', error));
</code></pre>

    <button class="v-md-copy-code-btn" type="button">
      <i>
        <svg viewBox="64 64 896 896" focusable="false" data-icon="copy" width="1em" height="1em" fill="currentColor" aria-hidden="true">
          <path d="M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"></path>
        </svg>
      </i>
    </button><!--beforeend--></div><!--afterend--></div><hr>
